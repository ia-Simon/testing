package main

import (
	"encoding/json"
	"fmt"
	"os"

	"bitbucket.org/asappay/asapcard-iso8583/iso"
)

var message = "0200feff4401a8e1e00a00000000000000043136353230343733303030303030303031333030323030303030303030303031303030303030303030303031303030303030303030303031303030303131313031383238333236313030303030303631303030303030303030343336313832383332313131303235313231313130313131303539393931303030393732383338343030383130393030303030303238333336353230343733303030303030303031333d323531323130313030303030303030303030303333303030363030303131374d54462054455354414243313233544553544d544631394d65726368616e74206e616d65202020202020202020204d65726368616e74206369747920555341313132543432303730313033323137343332386b4f57673763716e6171636f456741426c44795537386b674c367361363331354d44534131423243333132313220203636343530313031323032333646333845363934382d353338382d343141362d424341342d4234393732334331393433373834303834303834303032363030323431303430303030303030373636333338352d313233343032314d44313030303030303332383030303042442020203034393030322020202020202020202059593132334142434445464142434445464748494a4b4c4d4e4f50515253545556575859"

func main() {
	specData, err := os.ReadFile("./spec/mastercard/mastercard-version-8583-single-message.json")
	if err != nil {
		panic(err)
	}
	var spec iso.Specification
	err = json.Unmarshal(specData, &spec)
	if err != nil {
		panic(err)
	}

	msg, err := iso.NewISO8583Message(&spec, []byte(message))
	if err != nil {
		panic(err)
	}

	data, err := msg.ToString(true)
	if err != nil {
		panic(err)
	}

	fmt.Print(data)
}
